// packages/db/prisma/schema.prisma

// 1. Define your database provider
datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL") // This loads from the .env file
}

// 2. Define your generator (this is what `npm install` uses)
generator client {
  provider = "prisma-client-js"
}

// 3. Define the Python generator (this is for your app)
// generator pyclient {
//   provider = "prisma-client-py"
//   output   = "../../../apps/searching-agent/.venv/lib/python3.13/site-packages/prisma" // Adjust path as needed
// }


// --- YOUR DATABASE MODELS ---

// Model for customers from the Retell AI calls
model Customer {
  id        String   @id @default(cuid())
  phone     String?  @unique
  email     String?  @unique
  name      String?
  createdAt DateTime @default(now())

  // Relation: One customer can have many call logs
  callLogs CallLog[]
}

// Model for the call logs (from Keshav & Monish's app)
model CallLog {
  id        String   @id @default(cuid())
  transcript String
  duration  Int // in seconds
  
  // --- NEW & UPDATED FIELDS ---
  startTime DateTime @default(now())
  endTime   DateTime?
  outcome   String? // "scheduled", "interested", "not_interested"
  notes     String?
  
  // --- THE DATABASE LINK ---
  // This links the call to a specific customer
  customerId String?
  customer   Customer? @relation(fields: [customerId], references: [id])
}

// Model for the properties (from your searching-agent)
model Property {
  id        String   @id @default(cuid())
  address   String
  price     Float
  beds      Int?
  baths     Int?
  source    String   // e.g., "NemotronSearch", "Zillow"
  foundAt   DateTime @default(now())
}
